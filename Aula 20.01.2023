SELECT *
FROM TB_PACIENTE


SELECT *
FROM TB_PACIENTE
WHERE SEXO = 1
ORDER BY DT_NASCIMENTO, PACIENTE


SELECT PACIENTE, ESTADO_CIVIL, SEXO
FROM TB_PACIENTE
WHERE ESTADO_CIVIL = 3 OR ESTADO_CIVIL= 6 OR ESTADO_CIVIL= 7
ORDER BY PACIENTE DESC

SELECT PACIENTE, ESTADO_CIVIL, SEXO
FROM TB_PACIENTE
WHERE ESTADO_CIVIL IN (3,6,7)
ORDER BY PACIENTE DESC


SELECT *
FROM TB_PACIENTE
WHERE ESTADO_CIVIL = 9 AND SEXO =1

SELECT *
FROM TB_PASSAGEM
WHERE DATEPART(YEAR, DATA_ADMISSAO) = 2017

SELECT *
FROM TB_PASSAGEM
WHERE DATA_ADMISSAO BETWEEN '2017.1.1' AND '2017.12.31 23:59'

SELECT *
FROM TB_PASSAGEM
WHERE DATEPART(MONTH, DATA_ADMISSAO) = 1 OR DATEPART(MONTH, DATA_ADMISSAO) = 2
ORDER BY DATA_ADMISSAO

SELECT YEAR(DATA_ADMISSAO) AS ANO, MONTH(DATA_ADMISSAO) AS MES, DAY(DATA_ADMISSAO) AS DIA,  DT_ALTA
FROM TB_PASSAGEM

SELECT DATEPART(YEAR, DATA_ADMISSAO) AS ANO, DATEPART(MONTH, DATA_ADMISSAO) AS MES, DATEPART(DAY, DATA_ADMISSAO) AS DIA,  DT_ALTA
FROM TB_PASSAGEM

--INNER JOIN
SELECT P.PACIENTE,P.DT_NASCIMENTO,PASS.DATA_ADMISSAO
FROM TB_PACIENTE AS P
JOIN TB_PASSAGEM AS PASS ON P.ID_PACIENTE=PASS.ID_PACIENTE

--INNER JOIN WITH LIKE
SELECT P.PACIENTE, P.DT_NASCIMENTO, P.SEXO, PASS.DATA_ADMISSAO,PASS.DT_ALTA
FROM TB_PACIENTE AS P
JOIN TB_PASSAGEM AS PASS ON P.ID_PACIENTE=PASS.ID_PACIENTE
WHERE P.PACIENTE LIKE 'M%' AND YEAR(PASS.DATA_ADMISSAO) BETWEEN 2015 AND 2018

SELECT *
FROM TB_estadoCivil

SELECT P.ID_PACIENTE,P.PACIENTE,P.SEXO,EST.Desc_estadoCivil
FROM TB_PACIENTE AS P
JOIN TB_estadoCivil AS EST ON P.ESTADO_CIVIL=EST.id_estadocivil


SELECT P.ID_PACIENTE,P.PACIENTE,P.SEXO,EST.Desc_estadoCivil,
CASE WHEN P.SEXO=1 THEN'MASCULINO' ELSE 'FEMININO' END AS SEXO
FROM TB_PACIENTE AS P
JOIN TB_estadoCivil AS EST ON P.ESTADO_CIVIL=EST.id_estadocivil

SELECT COUNT(*)
FROM TB_PACIENTE

SELECT COUNT(*)
FROM TB_ENDERECO


SELECT COUNT(LOGRADOURO)
FROM TB_ENDERECO

SELECT COUNT(DISTINCT ID_PACIENTE)
FROM TB_PASSAGEM


SELECT COUNT(*) AS QTD, YEAR(DATA_ADMISSAO) AS ANO
FROM TB_PASSAGEM
GROUP BY YEAR(DATA_ADMISSAO)
ORDER BY 2 --DA PARA ORDENAR PELA POSIÇÃO DA COLUNA NO CASO A SEGUNDA


SELECT *
FROM TB_PASSAGEM_ITEM

SELECT YEAR(DATA_ADMISSAO), SUM(ITEM.QUANTIDADE*I.PRECO_VENDA) AS TOTAL
FROM TB_PASSAGEM_ITEM AS ITEM
JOIN TB_PASSAGEM AS PASS ON ITEM.ID_PASSAGEM=PASS.ID_PASSAGEM
JOIN TB_ITEM AS I ON ITEM.ID_ITEM=I.ID_ITEM
GROUP BY YEAR(DATA_ADMISSAO)
